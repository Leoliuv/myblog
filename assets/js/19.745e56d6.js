(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{199:function(t,a,s){"use strict";s.r(a);var e=s(0),r=Object(e.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h4",{attrs:{id:"percona-toolkit工具包安装使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#percona-toolkit工具包安装使用","aria-hidden":"true"}},[t._v("#")]),t._v(" percona-toolkit工具包安装使用")]),t._v(" "),s("h5",{attrs:{id:"_1-简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-简介","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 简介")]),t._v(" "),s("p",[t._v("​\t用来执行各种通过手工执行非常复杂和麻烦的mysql和系统任务，可以查看当前服务的摘要信息，磁盘检测，分析慢查询日志，查找重复索引，实现表同步等等")]),t._v(" "),s("h5",{attrs:{id:"_2-安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 安装")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("下载linux通用版本：https://www.percona.com/downloads/percona-toolkit")])]),t._v(" "),s("li",[s("p",[t._v("解压工具： tar -xzvf  percona-toolkit-3.0.13_i386.tar.gz")])]),t._v(" "),s("li",[s("p",[t._v("检查安装是否成功：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("[iddbs@host-172-18-231-117 percona-toolkit-3.0.9]$ bin/pt-table-checksum --version\n")])])]),s("p",[t._v("返回版本号则表示成功")])])]),t._v(" "),s("h5",{attrs:{id:"_3-使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-使用","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 使用")]),t._v(" "),s("h6",{attrs:{id:"_1-开发类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-开发类","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 开发类")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("pt-duplicate-key-checker 检查是否有重复的索引，给出重复的索引信息，包括索引定义，列的数据类型、以及修复建议。该工具以库为最小统计级别")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("pt-duplicate-key-checker --host=172.18.231.117 --port=21000 --user='mysql' --password=mysql --databases=test\n")])])])]),t._v(" "),s("li",[s("p",[t._v("pt-online-schema-change")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('pt-online-schema-change h=172.18.231.117,P=21000,u=mysql,p=mysql,D=test,t=test01 --set-vars --lock-wait-timeout=10 --execute --alter "modify name varchar(15);"\n')])])]),s("p",[t._v("将test.test01中的name属性修改为varchar(15)")]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("pt-show-grants")])]),t._v(" "),s("p",[t._v("指定具体mysql，打印改mysql的所有授权语句")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("pt-show-grants h=172.231.117,P=21000,u=mysql,p=mysql\n")])])]),s("p",[s("img",{attrs:{src:"/ph/1570687504120.png",alt:"1570687504120"}})])]),t._v(" "),s("li",[s("p",[t._v("pt-upgrade")]),t._v(" "),s("p",[t._v("用来测试新老版本数据库对sql的结果是否一致。两台开发测试数据库，一台是老版本，一台是新版本，来做比较，生产库别用")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("vi a.sql\nselect * from test01 where id =1;\n\npt-upgrade h=172.18.231.117,P=21000,u=mysql,p=mysql h=172.18.231.117,P=22000,u=mysql,p=mysql --database=test a.sql\n")])])]),s("p",[s("img",{attrs:{src:"/ph/1570688662108.png",alt:"1570688662108"}})])])]),t._v(" "),s("h6",{attrs:{id:"_2-性能类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-性能类","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.性能类")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("pt-index-usage")]),t._v(" "),s("p",[t._v("分析日志中索引使用情况，并出报告")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("pt-index-usage /paas/iddbs/liuli/mysql01/mysql/21000/error.log --host=172.18.231.117 --port=21000 --user=mysql --password=mysq\n")])])])])]),t._v(" "),s("p",[t._v("2.pt-pmp")]),t._v(" "),s("p",[t._v("​\t为查询结果跟踪，并汇总跟踪结果.一是获取进程的堆栈信息，二是对这些堆栈信息进行汇总。底层程序行为效率跟踪")]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[s("p",[t._v("pt-visual-explain")]),t._v(" "),s("p",[t._v("格式化执行计划，将explain的结果按照 tree 方式输出")])]),t._v(" "),s("li",[s("p",[t._v("pt-table-usage")]),t._v(" "),s("p",[t._v("简单分析下语句结构")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('pt-table-usage h=172.18.231.117,P=21000,u=mysql,p=mysql,D=test --query="select * from test01 where id=2;"\n')])])]),s("p",[s("img",{attrs:{src:"/ph/1570690601735.png",alt:"1570690601735"}})])])]),t._v(" "),s("h6",{attrs:{id:"_3-配置类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置类","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.配置类")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("pt-config-diff")]),t._v(" "),s("p",[t._v("检查来自于通过命令行指定的两个或者两个以上的config中的服务器系统变量值，以此来diff不同MySQL实例间的配置。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("pt-config-diff h=172.18.231.117,P=21000,u=mysql,p=mysql h=172.18.231.117,P=22000,u=mysql,p=mysql\n")])])]),s("p",[s("img",{attrs:{src:"/ph/1570690980418.png",alt:"1570690980418"}})])]),t._v(" "),s("li",[s("p",[t._v("pt-mysql-summary")]),t._v(" "),s("p",[t._v("对mysql配置和status进行汇总，主要用来输出MySQL的基本信息，可以作为数据库巡检以及刚开始熟悉数据库环境时候进行使用")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("pt-mysql-summary --host=172.18.231.117 --port=21000 --user=mysql --password=mysql\n")])])]),s("p",[s("img",{attrs:{src:"/ph/1570691172303.png",alt:"1570691172303"}}),t._v(" "),s("img",{attrs:{src:"/ph/1570691203134.png",alt:"1570691203134"}})])]),t._v(" "),s("li",[s("p",[t._v("pt-variable-advisor")]),t._v(" "),s("p",[t._v("是一款分析参数，并且给出参数设置建议的一款PT工具，得出的结果仅供参考，可根据业务需求做变动")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("pt-variable-advisor u=mysql,p=mysql,h=172.18.231.117,P=21000\n")])])]),s("p",[s("img",{attrs:{src:"/ph/1570691308360.png",alt:"1570691308360"}})])])]),t._v(" "),s("h6",{attrs:{id:"_4-监控类（未完）"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-监控类（未完）","aria-hidden":"true"}},[t._v("#")]),t._v(" 4.监控类（未完）")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("pt-mext")]),t._v(" "),s("p",[t._v("并行查看status样本信息")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("pt-mext -r -- mysqladmin ext -i10 -c3 --host=172.18.231.117 --port=21000 --user=mysql --password=mysql\n")])])]),s("p",[s("img",{attrs:{src:"/ph/1570691831328.png",alt:"1570691831328"}})])]),t._v(" "),s("li",[s("p",[t._v("pt-query-digest")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("pt-query-digest 172.18.231.117-21000-slowsql-error.log\n")])])])])]),t._v(" "),s("h6",{attrs:{id:"_5-复制类（未完）"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-复制类（未完）","aria-hidden":"true"}},[t._v("#")]),t._v(" 5.复制类（未完）")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("pt-heartbeat")]),t._v(" "),s("p",[t._v("a. 创建heartbeat表")]),t._v(" "),s("p",[t._v("b. 更新heartbeat表，获得最新的数据")]),t._v(" "),s("p",[t._v("c. 开启监控进程，这个是不停的刷新的")])]),t._v(" "),s("li",[s("p",[t._v("pt-slave-delay")]),t._v(" "),s("p",[t._v("故意让主上的操作延迟制定的时间写入到从，解决主库误操作的问题，但是需要长期运行该命令，比较耗费资源")])]),t._v(" "),s("li",[s("p",[t._v("pt-slave-find")]),t._v(" "),s("p",[t._v("查找和打印MySQL从库的复制层次树")])]),t._v(" "),s("li",[s("p",[t._v("pt-slave-restart")]),t._v(" "),s("p",[t._v("监控一个或者多个MySQL复制slave的错误，然后当复制停止时试图重启")])]),t._v(" "),s("li",[s("p",[t._v("pt-table-checksum")]),t._v(" "),s("p",[t._v("在线检测主从数据一致性的工具。通过pt-table-checksum检测出数据不一致后，可以通过pt-table-sync进行数据不一致的修复")])]),t._v(" "),s("li",[s("p",[t._v("pt-table-sync")])])]),t._v(" "),s("h6",{attrs:{id:"_6-系统类（未完）"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-系统类（未完）","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.系统类（未完）")])])},[],!1,null,null,null);a.default=r.exports}}]);