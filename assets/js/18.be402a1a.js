(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{201:function(_,a,s){"use strict";s.r(a);var l=s(0),t=Object(l.a)({},function(){var _=this,a=_.$createElement,s=_._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[s("h4",{attrs:{id:"mysql5-7升级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql5-7升级","aria-hidden":"true"}},[_._v("#")]),_._v(" MySQL5.7升级")]),_._v(" "),s("h5",{attrs:{id:"_1-升级方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-升级方法","aria-hidden":"true"}},[_._v("#")]),_._v(" 1. 升级方法")]),_._v(" "),s("ul",[s("li",[_._v("原地升级，直接替换老的MySQL程序\n"),s("ol",[s("li",[_._v("停止老MySQL")]),_._v(" "),s("li",[_._v("使用新的MySQL程序替换替换老的MySQL程序")]),_._v(" "),s("li",[_._v("重启MySQL")]),_._v(" "),s("li",[_._v("运行mysql_upgrade")])])]),_._v(" "),s("li",[_._v("逻辑升级，导出以前数据再导入新版本\n"),s("ol",[s("li",[_._v("从老版本中导入mysql")]),_._v(" "),s("li",[_._v("安装新版本")]),_._v(" "),s("li",[_._v("将数据导入到新版mysql")]),_._v(" "),s("li",[_._v("运行mysql_upgrade")])])])]),_._v(" "),s("h4",{attrs:{id:"_2-升级路径"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-升级路径","aria-hidden":"true"}},[_._v("#")]),_._v(" 2.升级路径")]),_._v(" "),s("ul",[s("li",[_._v("5.7 发布的系列版本之间升级。可以从5.7.9升级到5.7.10，跳过小版本升级也是可以的，从5.7.9升级到5.7.11")]),_._v(" "),s("li",[_._v("发行版的大版本升级。从5.6.*升级到5.7。升级跨域不止一个版本也是支持的，但是一次只能升级一个发行版，例如现在运行的是5.5，要升级到5.7就需要先升级到5.6再升级到5.7。")])]),_._v(" "),s("h4",{attrs:{id:"_3-升级前的准备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-升级前的准备","aria-hidden":"true"}},[_._v("#")]),_._v(" 3.升级前的准备")]),_._v(" "),s("ol",[s("li",[s("p",[_._v("备份一份当前的数据库")])]),_._v(" "),s("li",[s("p",[_._v("查看要升级版本的新特性")])]),_._v(" "),s("li",[s("p",[_._v("确实在升级前和升级后需要进行操作动作")])]),_._v(" "),s("li",[s("p",[_._v("是否需要改变表格式、字符集、collections等。")])]),_._v(" "),s("li",[s("p",[_._v("登入要升级的数据库查看数据库的版本")]),_._v(" "),s("p",[s("code",[_._v("select version()")])]),_._v(" "),s("p",[s("code",[_._v("status")])]),_._v(" "),s("ol",{attrs:{start:"6"}},[s("li",[_._v("下载要升级的安装包，上传服务器")]),_._v(" "),s("li",[_._v("关闭分布式数据库代理，防止升级期间连接数据库")])])])]),_._v(" "),s("h4",{attrs:{id:"升级步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#升级步骤","aria-hidden":"true"}},[_._v("#")]),_._v(" 升级步骤")]),_._v(" "),s("ol",[s("li",[s("p",[_._v("备份数据库")]),_._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[_._v("./bin/mysqldump -uroot -proot --socket=/paas/iddbs/liuli/mysql01/mysql/21000/mysql.sock --single-transaction --skip-add-locks --master-data=2 --all-databases>/paas/iddbs/liuli/mysql01/mysql/21000back/1010_57_27.sql\n")])])])]),_._v(" "),s("li",[s("p",[_._v("将数据库停止")]),_._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[_._v("./bin/mysqladmin -uroot -proot -h127.0.0.1 -P21000 shutdown\n")])])])]),_._v(" "),s("li",[s("p",[_._v("备份就得MySQL")]),_._v(" "),s("p",[s("code",[_._v("mv mysql mysql_20191008")])]),_._v(" "),s("p",[_._v("将准备好的新版本解压后移动到原来mysql的目录下，之后移动MySQL的数据目录和配置文件etc的目录")])]),_._v(" "),s("li",[s("p",[_._v("启动并登录MySQL")]),_._v(" "),s("p",[s("code",[_._v("./bin/mysqld_safe --defaults-file=/paas/iddbs/liuli/mysql01/mysql/etc/my21000.cnf &")])]),_._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[_._v("./bin/mysql -uroot -proot -h127.0.0.1 -P21000\n")])])])]),_._v(" "),s("li",[s("p",[_._v("升级操作")]),_._v(" "),s("p",[s("code",[_._v("./bin/mysql_upgrade -uroot -proot -h127.0.0.1 -P21000")])])]),_._v(" "),s("li",[s("p",[_._v("升级之后重启MySQL")])]),_._v(" "),s("li",[s("p",[_._v("修改配置文件")]),_._v(" "),s("p",[_._v("在~/.bash_profile增加配置")]),_._v(" "),s("p",[_._v("export PATH=/paas/iddbs/mysql/bin:$PATH\n然后刷新配置文件\nsource   ~/.b ash_profile")]),_._v(" "),s("p",[s("strong",[_._v("补充：在升级的时候，一般先对从库进行升级，若升级失败也不会影响到生产，如果升级成功，测试也成功，就慢慢的将其他的从库升级到新版本，最后将主库下线，提升一个新的从库作为新的主库，对旧的主库进行升级")])])])]),_._v(" "),s("h6",{attrs:{id:"mysql从5-7升级到8-0版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql从5-7升级到8-0版本","aria-hidden":"true"}},[_._v("#")]),_._v(" MySQL从5.7升级到8.0版本")]),_._v(" "),s("p",[_._v("按照上述：")]),_._v(" "),s("ol",[s("li",[_._v("备份数据库")]),_._v(" "),s("li",[_._v("将原来数据库进行改名或")]),_._v(" "),s("li",[_._v("将新的安装文件改为原名")]),_._v(" "),s("li",[_._v("将配置数据文件和配置文件放入数据库")]),_._v(" "),s("li",[_._v("启动服务，尝试登入数据库")]),_._v(" "),s("li",[_._v("运行"),s("code",[_._v("./bin/mysql_upgrade -uroot -proot -h127.0.0.1 -P21000")])]),_._v(" "),s("li",[_._v("登入数据库查看目前数据库的版本")])]),_._v(" "),s("p",[s("img",{attrs:{src:"/ph/1570695843022.png",alt:"1570695843022"}})])])},[],!1,null,null,null);a.default=t.exports}}]);